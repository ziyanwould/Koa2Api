webpackJsonp([2],{"A/oQ":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),o=a("exGp"),i=a.n(o),l=a("Dd8w"),s=a.n(l),c=a("NYxO"),u=a("J68u"),d=a("dVH7"),p={components:{UploadImages:u.a,mavonEditerUpload:d.a},computed:s()({},Object(c.d)({categoryList:function(e){return e.category.categoryList},uploadTokenData:function(e){return e.uploadToken.uploadTokenData}})),data:function(){return{id:this.$route.params.id,upload:{},detail:{},ruleValidate:{title:[{required:!0,message:"The name cannot be empty",trigger:"blur"}],author:[{required:!0,message:"Author cannot be empty",trigger:"blur"}],categoryId:[{required:!0,message:"Please select the category",trigger:"change"}],tag:[{required:!0,message:"tag cannot be empty",trigger:"blur"}],cover:[{required:!0,message:"cover cannot be empty",trigger:"blur"}],introduction:[{required:!0,message:"Introduce cannot be empty",trigger:"blur"}],content:[{required:!0,message:"Please enter a personal content",trigger:"blur"},{type:"string",min:20,message:"content no less than 20 words",trigger:"blur"}]}}},created:function(){this.getCategory(),this.getArticleInfo()},methods:s()({},Object(c.b)({updateArticle:"article/updateArticle",getArticleDetail:"article/getArticleDetail",getCategoryList:"category/getCategoryList"}),{getArticleInfo:function(){var e=this;return i()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getArticleDetail(e.id);case 3:a=t.sent,e.detail=a,e.upload.url=e.detail.cover,e.$Message.success("获取文章成功"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0),e.$Message.error("获取文章失败");case 13:case"end":return t.stop()}},t,e,[[0,9]])}))()},getCategory:function(){var e=this;return i()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getCategoryList();case 3:e.$Message.success("获取分类成功"),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e.$Message.error("获取分类失败");case 9:case"end":return t.stop()}},t,e,[[0,6]])}))()},completeUpload:function(e){this.upload=e,this.detail.cover=e.url},handleEditor:function(e){this.detail.content=e},handleSubmit:function(e){var t,a=this;this.$refs[e].validate((t=i()(n.a.mark(function e(t){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}return e.prev=1,e.next=4,a.updateArticle(a.detail);case 4:a.$Message.success("更新成功"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),a.$Message.error("更新失败");case 10:e.next=13;break;case 12:a.$Message.error("Fail!");case 13:case"end":return e.stop()}},e,a,[[1,7]])})),function(e){return t.apply(this,arguments)}))},handleReset:function(e){this.$refs[e].resetFields()}})},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Form",{ref:"detail",attrs:{model:e.detail,rules:e.ruleValidate,"label-width":80}},[a("FormItem",{attrs:{label:"文章标题",prop:"title"}},[a("Input",{attrs:{placeholder:"title"},model:{value:e.detail.title,callback:function(t){e.$set(e.detail,"title",t)},expression:"detail.title"}})],1),e._v(" "),a("FormItem",{attrs:{label:"文章作者",prop:"author"}},[a("Input",{attrs:{placeholder:"author"},model:{value:e.detail.author,callback:function(t){e.$set(e.detail,"author",t)},expression:"detail.author"}})],1),e._v(" "),a("FormItem",{attrs:{label:"文章分类",prop:"category"}},[e.categoryList.length>0?a("Select",{staticStyle:{position:"relative","z-index":"9999"},attrs:{placeholder:"Select category"},model:{value:e.detail.categoryId,callback:function(t){e.$set(e.detail,"categoryId",t)},expression:"detail.categoryId"}},e._l(e.categoryList,function(t,r){return a("Option",{key:r,attrs:{value:t.id}},[e._v("\n        "+e._s(t.name)+"\n      ")])})):e._e()],1),e._v(" "),a("FormItem",{attrs:{label:"文章标签",prop:"introduce"}},[a("Input",{attrs:{placeholder:"tag"},model:{value:e.detail.tag,callback:function(t){e.$set(e.detail,"tag",t)},expression:"detail.tag"}})],1),e._v(" "),a("FormItem",{attrs:{label:"文章图片",prop:"banner"}},[a("upload-images",{on:{completeUpload:e.completeUpload}}),e._v(" "),e.upload?a("div",[a("img",{attrs:{src:e.upload.url,alt:"img"}})]):e._e()],1),e._v(" "),a("FormItem",{attrs:{label:"文章简介",prop:"introduce"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"introduce"},model:{value:e.detail.introduction,callback:function(t){e.$set(e.detail,"introduction",t)},expression:"detail.introduction"}})],1),e._v(" "),e.uploadTokenData?a("FormItem",{attrs:{label:"文章内容",prop:"content"}},[a("mavon-editer-upload",{attrs:{data:e.detail.content},on:{handleEditor:e.handleEditor}})],1):e._e(),e._v(" "),a("FormItem",[a("Button",{on:{click:function(t){e.handleReset("detail")}}},[e._v("重置")]),e._v(" "),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){e.handleSubmit("detail")}}},[e._v("更新")])],1)],1)},staticRenderFns:[]},m=a("VU/8")(p,g,!1,null,null,null);t.default=m.exports},TpW9:function(e,t){},dVH7:function(e,t,a){"use strict";var r=a("Dd8w"),n=a.n(r),o=a("NYxO"),i={props:["data"],data:function(){return{value:"",url:null,pos:null,file:null,loadingStatus:!1}},computed:n()({},Object(o.d)({uploadTokenData:function(e){return e.uploadToken.uploadTokenData}})),created:function(){null!=this.data&&(this.value=this.data)},watch:{data:function(){null!=this.data&&(this.value=this.data)}},methods:{editorChange:function(e){this.$emit("handleEditor",this.value)},imgAdd:function(e,t){this.pos=e,this.$refs.file.post(t)},handleAvatarSuccess:function(e,t){var a="http://cdn.boblog.com/"+e.key;this.$refs.md.$img2Url(this.pos,a)},handleAvatarError:function(){delete this.img_file[this.pos]}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("mavon-editor",{ref:"md",attrs:{ishljs:!0},on:{change:e.editorChange,imgAdd:e.imgAdd},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),e._v(" "),a("Upload",{ref:"file",staticClass:"avatar-uploader",staticStyle:{display:"none"},attrs:{action:"http://up-z2.qiniu.com","show-upload-list":!1,data:{token:e.uploadTokenData.token},"thumbnail-mode":!0,"on-success":e.handleAvatarSuccess,"on-error":e.handleAvatarError}})],1)},staticRenderFns:[]};var s=a("VU/8")(i,l,!1,function(e){a("TpW9")},null,null);t.a=s.exports}});
//# sourceMappingURL=2.f5ec7f001bddeff68db5.js.map